# Design Spec: 위젯별 상세 디자인 명세

> 각 위젯 타입의 UX 흐름, 화면 구성, 인터랙션, 데이터 구조를 정의한다.
> 공통 디자인 시스템은 [PRD.md](./PRD.md) 참조.
>
> **범례**: ✅ 구현 완료 | 🚧 미구현 (Phase 2)

---

## 1. 타임테이블 (Timetable)

### 1-1. 컨셉
요일별 시간표를 만들어 **각 요일마다 배경화면이 자동으로 바뀌는** 시스템.
드래그 배치가 아닌, **탭하면 시간 순서에 맞게 자동 정렬**되는 간편한 UX.

### 1-2. 화면 흐름

```
[타입 선택] → [뷰 타입·레이아웃 선택] → [요일 선택] → [시간표 편집] → [저장/내보내기]
```

### 1-3. 상단 컨트롤 바 ✅

| 요소 | 설명 |
|------|------|
| 뷰 타입 토글 | `블록` / `원형` 토글 칩 (좌측) |
| 레이아웃 토글 | `데일리` / `위클리` 토글 칩 (우측) |
| 주말 토글 | `주말 ON/OFF` 버튼 — 토/일 표시 여부 |

### 1-4. 요일 선택 (데일리 모드) ✅

| 요소 | 설명 |
|------|------|
| 요일 탭 바 | `월 화 수 목 금 (토 일)` 가로 탭, 선택된 요일 = 노란 하이라이트 |
| 요일별 독립 | 각 요일마다 별도의 스케줄 데이터 저장 |

### 1-5. 시간표 편집 화면 ✅

#### 일정 추가 방식 (탭 기반, 드래그 X)
1. 하단 **"+ 일정 추가"** 버튼 탭
2. 모달에서 **제목** 입력
3. **시작 시간** / **종료 시간** 입력 (H:MM 텍스트 필드)
4. **색상** 선택 (8색 팔레트)
5. **확인** → 시간 순서대로 자동 정렬

#### 블록 디자인 규칙
- ✅ 시간 길이에 비례한 블록 높이 (HOUR_HEIGHT = 52px 기준)
- ✅ 블록 길게 누르기 → 삭제
- 🚧 블록 탭 → 인라인 편집 (이름, 시간, 색상 변경)
- 🚧 시간 겹침 → 경고 표시 + 자동 조정 제안

#### 데일리 블록 뷰 ✅
```
┌─────────────────────────┐
│  06  ──────────────────  │  ← 시간 눈금 (6시~23시)
│  07  ──────────────────  │
│  ...                     │
│  09  ┌───────────────┐   │
│      │ UI/UX 기획     │   │  ← 블록 (파랑, 비례 높이)
│  10  └───────────────┘   │
│  ...                     │
│  12  ┌───────────────┐   │
│      │ 점심           │   │  ← 블록 (핑크)
│  13  └───────────────┘   │
└─────────────────────────┘
```

#### 위클리 블록 뷰 ✅
- 요일 × 시간 그리드 형태
- 상단에 요일 헤더 (월~일)
- 좌측에 시간 라벨 (6시~23시)
- 각 요일 열에 일정 블록 렌더링

### 1-6. 타입 분기: 블록형 vs 원형 ✅

| 타입 | 설명 |
|------|------|
| **블록형** (기본) | 세로 타임라인 형태의 시간표. 위에서 아래로 시간순 정렬 |
| **원형** | 12시간 원형 시계 위에 일정이 파이 영역으로 채워지는 형태 |

#### 원형 타입 현재 구현 ✅
- SVG 기반 원형 시계판 (빈 원 + 12개 눈금)
- 일정 추가 시 해당 시간 영역이 파이 Arc로 채워짐
- 중앙에 노란 원 + 요일 라벨 표시
- 시간 라벨: 12시, 3시, 6시, 9시 기준
- 하단에 범례 리스트 (색상 + 시간 + 제목)
- 블록형과 **동일한 데이터 공유** (뷰 타입 전환만으로 변환)

#### 위클리 원형 뷰 ✅
- 요일별 미니 원형 시계 (80px) 그리드
- 각 미니 시계에 요일 라벨 + 일정 수 표시

#### 원형 미구현 기능 🚧
- 12시간 / 24시간 모드 전환 UI (데이터 필드 `clockMode`는 존재)
- 빈 영역 탭 → 해당 시간대에 일정 추가
- 채워진 영역 탭 → 일정 편집/삭제
- 핀치 줌으로 12h↔24h 전환 애니메이션
- 스와이프로 요일 전환
- 디자인 변형 (심플/도넛/해시계) 선택

### 1-7. 데이터 모델 (실제 구현)

```typescript
interface TimetableData {
  viewType: 'block' | 'circle';
  layoutMode: 'daily' | 'weekly';     // 스펙 추가: 레이아웃 모드
  clockMode: '12h' | '24h';
  showWeekend: boolean;                // 스펙 추가: 주말 표시 여부
  selectedDay: DayOfWeek;
  days: Record<DayOfWeek, ScheduleItem[]>;
}

interface ScheduleItem {
  id: string;
  startTime: string;    // "09:00"
  endTime: string;      // "10:30"
  title: string;
  color: string;
  emoji?: string;
}

type DayOfWeek = 'mon' | 'tue' | 'wed' | 'thu' | 'fri' | 'sat' | 'sun';
```

> **원래 스펙 대비 변경점**:
> - `layoutMode`, `showWeekend`, `selectedDay` 필드 추가
> - `style.blockStyle` (rounded/sharp/wavy) 제거 — Neubrutalism 비대칭 radius 하드코딩으로 대체
> - `style.backgroundColor`, `style.font`는 Project 레벨에서 관리

### 1-8. 배경화면 자동 전환 🚧
- 저장 시 요일별 7장의 배경화면 이미지 생성
- iOS 단축어 / Android 자동화 연동 가이드 제공
- 앱 내에서 "오늘의 배경화면" 원탭 적용

---

## 2. 원형 시계 (Circle Clock)

> 타임테이블의 원형 타입으로 **완전 통합**. 독립 진입점은 제거.
> 상세는 **1-6 ~ 1-7** 참조.

---

## 3. 타임 게이지 (Time Gauge)

### 3-1. 컨셉
**현재 시각 기반의 시계**. 하루 24시간이 게이지(프로그레스 바)로 표현되어,
현재 시간이 얼마나 흘렀는지 시각적으로 보여준다.

### 3-2. 화면 흐름

```
[타입 선택] → [게이지 프리뷰 + 스타일/옵션 편집] → [저장]
```

### 3-3. 게이지 스타일 옵션 ✅ (5가지 모두 구현)

| 스타일 | 설명 | 구현 방식 |
|--------|------|-----------|
| **가로바** (horizontal) | 좌→우로 채워지는 가로 프로그레스 바 | View 기반 |
| **세로바** (vertical) | 아래→위로 채워지는 세로 프로그레스 바 | View 기반 |
| **원형** (circular) | 시계방향으로 채워지는 원형 | SVG Circle strokeDashoffset |
| **물채움** (water) | 아래에서 물이 차오르는 웨이브 | SVG Path + ClipPath |
| **배터리** (battery) | 배터리 아이콘에 남은 시간 표시 | View 기반 (돌기 포함) |

### 3-4. 커스터마이즈 옵션 ✅

| 옵션 | 설명 | 구현 상태 |
|------|------|-----------|
| 시작/끝 시간 | 기본 00:00~24:00, +/- 30분 단위 조절 | ✅ |
| 표시 형식 | 퍼센트(%), 남은 시간, 경과 시간 | ✅ |
| 라벨 텍스트 | 커스텀 텍스트 (기본: "오늘 하루"), 최대 20자 | ✅ |
| 게이지 색상 | 8색 팔레트에서 채움 색 선택 | ✅ |
| 캐릭터 | 게이지 위 이모지 (🏃🚀⚡🔥💧☀️🌙⭐) 또는 없음 | ✅ |

### 3-5. 실시간 업데이트 ✅
- 1분마다 진행률 재계산 (`setInterval` 60초)
- 배경화면: 저장 시점의 시간으로 스냅샷 (정적 이미지) 🚧
- 위젯: 실시간 업데이트 (OS 위젯으로 동작) 🚧

### 3-6. 데이터 모델 (실제 구현)

```typescript
interface TimeGaugeData {
  gaugeStyle: 'horizontal' | 'vertical' | 'circular' | 'water' | 'battery';
  startTime: string;        // "00:00"
  endTime: string;          // "24:00"
  displayFormat: 'percent' | 'remaining' | 'elapsed';
  label: string;
  fillColor: string;        // 단일 채움 색상
  character?: string;       // 게이지 위 이모지
}
```

> **원래 스펙 대비 변경점**:
> - `colors: { fill, background, text }` → `fillColor` 단일 필드로 단순화
> - `style.backgroundColor`, `style.font`는 Project 레벨에서 관리
> - `id` 필드 제거 (Project.id로 대체)

---

## 4. 라이프 프로그레스 (Life Progress)

### 4-1. 컨셉
**태어난 날 ~ 예상 사망일** 사이의 인생 진행률을 시각화.
다양한 프로그레스 바 디자인으로 표현.

### 4-2. 화면 흐름

```
[타입 선택] → [프리뷰 + 디자인 타입 선택 + 설정 편집] → [저장]
```

### 4-3. 입력 화면 ✅

| 입력 | 설명 | 구현 상태 |
|------|------|-----------|
| 생년월일 | 텍스트 입력 (YYYY-MM-DD 형식) | ✅ (네이티브 날짜 피커는 🚧) |
| 예상 수명 | 탭 슬라이더 + ±1 미세조정 버튼 (기본: 80세), 범위: 50~120세 | ✅ |
| 단위 선택 | 년 / 월 / 주 / 일 중 택1 (프로그레스 표시 단위) | ✅ |
| 모토 문구 | 선택적 텍스트, 최대 40자 | ✅ |

### 4-4. 프로그레스 바 디자인 옵션 ✅ (6가지 모두 구현)

| 디자인 | 설명 | 구현 방식 |
|--------|------|-----------|
| **기본 바** (bar) | 가로 프로그레스 바 + 퍼센트 + 경과/남은 통계 | View 기반 |
| **도트 매트릭스** (dots) | 50×20 축소 그리드로 주 단위 점 표시 | View 그리드 |
| **나무 성장** (tree) | 🌱→🌿→🌳→🍂 4단계 이모지 + 라벨 | 이모지 기반 |
| **책 페이지** (book) | 📖 + Chapter X/10 + 페이지 수 | 텍스트 기반 |
| **달 위상** (moon) | 🌑~🌘 8단계 달 이모지 | 이모지 기반 |
| **픽셀 아트** (pixel) | 10×10 격자 칸 채우기 | View 그리드 |

### 4-5. 색상 설정 ✅
- 채워진 영역 / 남은 영역 색상을 독립적으로 선택
- 6색 팔레트 (`#FFDE59`, `#91D0FF`, `#FF91AD`, `#F0FFF4`, `#FFD6E0`, `#C1F0C1`)
- 색상 대상 토글: "채워진 영역" / "남은 영역" 탭으로 전환

### 4-6. 데이터 모델 (실제 구현)

```typescript
interface LifeProgressData {
  birthDate: string;              // "1996-03-15"
  expectedLifespan: number;       // 80 (세)
  displayUnit: 'year' | 'month' | 'week' | 'day';
  designType: 'bar' | 'dots' | 'tree' | 'book' | 'moon' | 'pixel';
  showDetails: boolean;           // 상세 날짜 정보 표시 여부 (UI 미연결 🚧)
  motto?: string;
  filledColor: string;            // 채워진 영역 색상
  remainingColor: string;         // 남은 영역 색상
}
```

> **원래 스펙 대비 변경점**:
> - `colors: { filled, remaining, text }` → `filledColor`, `remainingColor` 개별 필드로 플랫화
> - `showDetails` 필드는 존재하나 UI 토글 미연결
> - `style.backgroundColor`, `style.font`는 Project 레벨에서 관리

---

## 5. 모토 낙서 (Motto & Doodle)

### 5-1. 컨셉
사용자가 원하는 **문구(글귀)를 배치**하고 꾸미는 배경화면.
다양한 레이아웃과 타이포그래피 디자인 제공.

### 5-2. 화면 흐름

```
[타입 선택] → [프리뷰 + 템플릿 선택] → [문구 입력/편집] → [저장]
```

### 5-3. 디자인 템플릿 ✅ (8가지 모두 구현)

| 템플릿 | 설명 | 구현 방식 |
|--------|------|-----------|
| **중앙 집중** (center) | 화면 중앙에 크게 배치 | 기본 중앙 정렬 |
| **말풍선** (bubble) | 만화 말풍선 안에 텍스트 | Neubrutalism 카드 + 꼬리 삼각형 |
| **포스트잇** (postit) | 노란 배경, -3도 회전 | 노란 카드 + rotate transform |
| **타이프라이터** (typewriter) | 모노스페이스 빈티지 텍스트 | Courier 폰트 + 두꺼운 상단 보더 |
| **줄노트** (notebook) | 줄 배경 + 빨간 세로줄 | 반복 borderBottom + redLine |
| **도장** (stamp) | 이중 테두리 프레임, -5도 회전 | 핑크 이중 보더 |
| **네온사인** (neon) | 어두운 배경 + 핑크 글로우 | textShadow 이중 레이어 |
| **콜라주** (collage) | 주변 이모지 + 중앙 텍스트 | 절대 위치 이모지 6개 배치 |

### 5-4. 문구 편집 옵션

| 옵션 | 설명 | 구현 상태 |
|------|------|-----------|
| 텍스트 입력 | 자유 입력 (여러 줄 가능) | ✅ |
| 크기 | A-/A+ 버튼 (12~64px) + 시각적 바 | ✅ |
| 색상 | 7색 팔레트 (검정, 흰색, 핑크, 파랑, 노랑, 연두, 하늘) | ✅ |
| 정렬 | 좌 / 중앙 / 우 | ✅ |
| 강조 | 밑줄, 형광펜, 동그라미 | ✅ |
| 폰트 | 현재 Gaegu 단일. 폰트 선택 UI | 🚧 |
| 회전 | 데이터 필드 존재, 조절 UI | 🚧 |

> **현재 제한**: 단일 텍스트만 편집 (`texts[0]`). 여러 텍스트 독립 추가/편집은 🚧.

### 5-5. 디자인 시각화

```
템플릿 A: 중앙 집중              템플릿 B: 말풍선

┌──────────────────┐          ┌──────────────────┐
│                  │          │     ╭─────────╮   │
│                  │          │    ╱           │   │
│   오늘도 화이팅   │          │   │ 오늘도     │   │
│                  │          │   │  화이팅!   │   │
│                  │          │   ╰───────────╯   │
│                  │          │       ╲            │
└──────────────────┘          └──────────────────┘

템플릿 C: 포스트잇              템플릿 D: 낙서장

┌──────────────────┐          ┌──────────────────┐
│                  │          │  ─────────────── │
│   ┌────────┐     │          │  오늘도 화이팅   │
│   │오늘도  │╲    │          │  ─────────────── │
│   │화이팅! │ │   │          │  │(빨간 세로줄)   │
│   └────────┘     │          │  ─────────────── │
│            ↗ 살짝 회전       │  (줄노트 배경)    │
└──────────────────┘          └──────────────────┘
```

### 5-6. 데이터 모델 (실제 구현)

```typescript
interface MottoData {
  template: MottoTemplate;
  texts: MottoText[];           // 현재 texts[0]만 편집됨
}

type MottoTemplate = 'center' | 'bubble' | 'postit' | 'typewriter' | 'notebook' | 'stamp' | 'neon' | 'collage';

interface MottoText {
  id: string;
  content: string;
  fontSize: number;
  color: string;
  align: 'left' | 'center' | 'right';
  rotation: number;
  position: { x: number; y: number };
  emphasis?: 'underline' | 'highlight' | 'circle';
}
```

> **원래 스펙 대비 변경점**:
> - `decorations: Decoration[]` 제거 — 콜라주 템플릿에서 하드코딩된 이모지로 대체
> - `style.backgroundColor`, `style.font`는 Project 레벨에서 관리
> - 여러 텍스트 편집은 데이터 구조상 가능하나 UI는 단일 텍스트만 지원

---

## 6. 다꾸 - 믹스앤매치 (Mix & Match)

### 6-1. 컨셉
다이어리 꾸미기(다꾸)처럼 **사용자가 자유롭게 요소를 배치**하는 캔버스.
스티커, 텍스트, 도형, 마스킹 테이프를 드래그 앤 드롭으로 꾸민다.

### 6-2. 화면 흐름

```
[타입 선택] → [빈 캔버스 + 바텀 탭에서 요소 추가] → [드래그로 배치] → [저장]
```

### 6-3. 추가 가능한 요소

| 요소 | 설명 | 구현 상태 |
|------|------|-----------|
| **스티커** | 15종 이모지 스티커 (✨💖🍀⭐☕🎧🏃📚💤🍕🌸☀️🌈🔥🎵) | ✅ |
| **텍스트** | 자유 텍스트 박스 (Gaegu 폰트, 색상/크기 변경) | ✅ |
| **도형** | 원, 사각형, 하트, 별 (6색 팔레트) | ✅ |
| **마스킹 테이프** | 8색 반투명 와시 테이프 (랜덤 기울기) | ✅ |
| **사진** | 갤러리에서 사진 불러오기 | 🚧 |
| **스탬프** | 카테고리별 도장 에셋 | 🚧 |
| **라인/화살표** | 직선, 곡선, 화살표 | 🚧 |
| **프레임** | 폴라로이드, 우표 등 사진 프레임 | 🚧 |

### 6-4. 캔버스 인터랙션

| 제스처 | 동작 | 구현 상태 |
|--------|------|-----------|
| **탭** | 요소 선택 (파란 점선 테두리 + 삭제 버튼) | ✅ |
| **드래그** | 요소 위치 이동 (Reanimated spring 애니메이션) | ✅ |
| **캔버스 탭** | 선택 해제 | ✅ |
| **길게 누르기 (텍스트)** | 텍스트 인라인 편집 | ✅ |
| **핀치** | 요소 크기 조절 | 🚧 |
| **두 손가락 회전** | 요소 회전 | 🚧 |
| **컨텍스트 메뉴** | 복제, 삭제, 레이어 순서 | 🚧 |

### 6-5. 레이어 시스템 ✅

| 기능 | 설명 | 구현 상태 |
|------|------|-----------|
| zIndex 관리 | 각 요소는 독립 레이어 | ✅ |
| 앞으로/뒤로 | 선택된 요소의 레이어 순서 변경 버튼 | ✅ |
| 레이어 잠금 | `locked` 필드 존재, 잠금 시 드래그 비활성화 | ✅ (UI 토글은 🚧) |

### 6-6. 바텀 탭 구성 ✅

```
[ 스티커 | 텍스트 | 도형 | 테이프 ]

스티커 탭:     15종 이모지 그리드 (탭하면 캔버스 중앙 근처에 추가)
텍스트 탭:     "+ 텍스트 추가" 버튼 + 힌트 안내
도형 탭:       4종 도형 선택 + 6색 팔레트
테이프 탭:     8색 마스킹 테이프 미리보기 (탭하면 추가)
```

> **원래 스펙 대비 변경점**:
> - 5탭 (사진 | 스탬프 | 스티커 | 텍스트 | 도형) → 4탭 (스티커 | 텍스트 | 도형 | 테이프)
> - 사진, 스탬프 탭은 Phase 2로 이동
> - 테이프가 도형 탭에서 독립 탭으로 분리

### 6-7. 데이터 모델 (실제 구현)

```typescript
// 다꾸 요소는 Project.mixElements 배열로 관리
type MixElementType = 'photo' | 'stamp' | 'sticker' | 'text' | 'shape' | 'tape' | 'frame';

interface MixElement {
  id: string;
  type: MixElementType;
  x: number;
  y: number;
  width: number;
  height: number;
  rotation: number;
  zIndex: number;
  locked: boolean;
  opacity: number;
  content: string;        // 텍스트, 이모지, 도형 종류(circle/rect/...) 등
  color?: string;
  fontSize?: number;
  fontFamily?: string;
  uri?: string;           // 사진 URI (🚧)
}
```

> **원래 스펙 대비 변경점**:
> - 별도 서브타입 인터페이스 (PhotoData, StampData, ShapeData 등) → **플랫한 단일 MixElement**로 단순화
> - `canvasSize`는 컴포넌트 내 상수로 관리 (스토어에 저장하지 않음)
> - `backgroundImage`는 Project.bgImage로 관리

---

## 공통: 저장 & 내보내기

### 현재 구현 상태

| 기능 | 설명 | 구현 상태 |
|------|------|-----------|
| Zustand 저장 | 프로젝트를 인메모리 목록에 저장 | ✅ |
| AsyncStorage | 앱 종료 후에도 데이터 유지 | 🚧 (의존성 설치됨) |
| 이미지 내보내기 | PNG/JPG로 저장 | 🚧 (view-shot, media-library 의존성 설치됨) |
| SNS 공유 | 이미지로 공유 | 🚧 |
| Undo/Redo | 편집 되돌리기 | 🚧 (버튼 UI만 존재) |

### 지원 해상도 🚧

| 기기 | 해상도 |
|------|--------|
| iPhone 15 Pro | 1179 x 2556 |
| iPhone 15 | 1170 x 2532 |
| iPad Pro 11" | 2388 x 1668 |
| Galaxy S24 | 1080 x 2340 |

---

## 타입 선택 화면 ✅

5개 타입, 2-2-1 배치. 마지막 행은 풀 너비로 "다꾸" 강조:

```
┌─────────┐ ┌─────────┐
│ 📅       │ │ ⏳       │
│ 타임     │ │ 타임     │
│ 테이블   │ │ 게이지   │
├─────────┤ ├─────────┤
│ 🌱       │ │ ✍️       │
│ 라이프   │ │ 모토 &   │
│ 프로그레스│ │ 낙서     │
├─────────┴─┴─────────┤
│ 🎨 다꾸 믹스앤매치    │
│ 자유롭게 다이어리 꾸미기│
└─────────────────────┘
```

- 배경화면 / 위젯 모드 토글 ✅
- 각 카드에 이모지 + 제목 + 설명 표시 ✅
- 위젯 모드일 때 "인터랙티브" 뱃지 표시 ✅

---

## 프로젝트 공통 데이터 모델 (실제 구현)

```typescript
interface Project {
  id: string;
  mode: 'wallpaper' | 'widget';
  widgetType: WidgetTypeId;
  title: string;
  bgColor: string;               // 배경색 (기본: #FFFDF9)
  bgImage?: string;              // 배경 이미지 URI
  createdAt: number;
  updatedAt: number;
  // 위젯별 데이터 (하나만 존재)
  timetableData?: TimetableData;
  timeGaugeData?: TimeGaugeData;
  lifeProgressData?: LifeProgressData;
  mottoData?: MottoData;
  mixElements?: MixElement[];
  // 범용 블록 (하위호환)
  elements: BlockElement[];
}

type WidgetTypeId = 'timetable' | 'timegauge' | 'progress' | 'motto' | 'mixmatch';
```
